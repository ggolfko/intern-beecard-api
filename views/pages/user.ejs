<!DOCTYPE html>
<html lang="en">

<head>
  <% include ../partials/head %>
</head>

<body class="container">

  <header>
    <% include ../partials/header %>
  </header>

  <main>
    <script>
      function myClick(id) {
        console.log(id)
        swal({
            title: "Are you sure?",
            text: "Once deleted, you will not be able to recover this imaginary file!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
          })
          .then((willDelete) => {
            if (willDelete) {
              $.post('http://localhost:7775/api/users/delete', {
                id: id
              }, function (data, status) {
                if (data.message == "delete success") {
                  swal("Poof! Your imaginary file has been deleted!", {
                  icon: "success",
                  }).then((willOk) => {
                    if (willOk) {
                      window.location.href = '/user'
                    }
                  })
                }else{
                  swal("you have some problem");
                }
              })
            } else {
              swal("Your imaginary file is safe!");
            }
          });

      }
    </script>

    <style>
      table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
      }

      td,
      th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
      }

      tr:nth-child(even) {
        background-color: #dddddd;
      }
    </style>
    <div class="jumbotron">
      <h2>Show users</h2>
      <table>
        <tr>
          <th>id</th>
          <th>firstname</th>
          <th>lastname</th>
          <th>username</th>
          <th>email</th>
          <th>tel</th>
          <th>more</th>
        </tr>

        <% data.forEach(function(Data) { %>
          <tr>
            <td>
              <%= Data.id %>
            </td>
            <td>
              <%= Data.firstname %>
            </td>
            <td>
              <%= Data.lastname %>
            </td>
            <td>
              <%= Data.username %>
            </td>
            <td>
              <%= Data.email %>
            </td>
            <td>
              <%= Data.tel %>
            </td>
            <td>
              <form>
                <button type="button" class="btn btn-info" onclick="window.location.href='/user/update?id=<%= Data.id %>'">edit</button>

              </form>
              <form>
                <button type="button" class="btn btn-danger" onclick="myClick('<%= Data.id %>')">delete</button>
              </form>
            </td>

          </tr>
          <% }); %>
      </table>

    </div>
  </main>


  <footer>
    <% include ../partials/footer %>
  </footer>

</body>

</html>